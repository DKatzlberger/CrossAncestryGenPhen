% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perm_aggregating_sets.R
\name{perm_aggregate_sets}
\alias{perm_aggregate_sets}
\title{Permutation-Based Aggregation Test for Feature Sets}
\usage{
perm_aggregate_sets(
  x,
  T_col,
  feature_col,
  agg_fun = mean,
  alternative = c("two.sided", "greater", "less"),
  B = 1000,
  seed = NULL
)
}
\arguments{
\item{x}{A data.frame or data.table containing the test statistics and feature assignments.}

\item{T_col}{Character. The name of the column in \code{x} that contains the test statistic to aggregate.}

\item{feature_col}{Character. The name of the column in \code{x} that defines feature groups.}

\item{agg_fun}{Function. Aggregation function applied to each feature set (e.g., \code{mean}, \code{median}). Defaults to \code{mean}.}

\item{alternative}{Character. The alternative hypothesis. One of \code{"two.sided"}, \code{"greater"}, or \code{"less"}.}

\item{B}{Integer. Number of permutations to perform. Defaults to 1000.}

\item{seed}{Integer or NULL. Random seed for reproducibility. Defaults to \code{NULL}.}
}
\value{
A data.frame with one row per feature containing:
\itemize{
  \item \code{feature} – Feature name.
  \item \code{T_obs} – Observed aggregated test statistic.
  \item \code{p_value} – Empirical p-value.
  \item \code{p_adj} – FDR-adjusted p-value (Benjamini-Hochberg).
  \item \code{alternative} – The specified alternative hypothesis.
}
}
\description{
Performs permutation testing for feature-level aggregated statistics.
This function computes an observed test statistic per feature using a
specified aggregation function (e.g., mean), and compares it to a null
distribution obtained by permuting values within each feature set.
}
\examples{
set.seed(123)
df <- data.frame(
  stat = rnorm(300),
  gene_set = rep(letters[1:10], each = 30)
)
result <- perm_aggregate_sets(df, T_col = "stat", feature_col = "gene_set", B = 100)
head(result)

}
