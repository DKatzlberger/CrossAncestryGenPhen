% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_pvalue_distribution.R
\name{plot_pvalue_distribution}
\alias{plot_pvalue_distribution}
\title{Plot P-value Distribution Colored by a Binned Fill Variable}
\usage{
plot_pvalue_distribution(
  data,
  x_var,
  fill_var = NULL,
  facet_col = NULL,
  facet_levels = NULL,
  title = NULL,
  x_label = NULL,
  y_label = NULL,
  fill_label = NULL,
  bins = 50,
  n_fill_bins = 9
)
}
\arguments{
\item{data}{A data frame containing at least the columns specified in \code{x_var} and \code{fill_var}.}

\item{x_var}{String. Name of the column to use for the x-axis (e.g., "p_value").}

\item{fill_var}{String. Name of the column used for fill coloring (e.g., "T_obs").}

\item{facet_col}{Optional. String. Name of a column to use for faceting the plot (e.g., "feature", "cluster"). If NULL, no faceting is applied.}

\item{facet_levels}{Optional. A character vector of levels to include in faceting. If NULL and \code{facet_col} is provided, the first 9 unique values are used.}

\item{title}{Optional. Character string to set the plot title.}

\item{x_label}{Label for the x-axis. Defaults to the value of \code{x_var}.}

\item{y_label}{Label for the y-axis. Defaults to \code{"Count"}.}

\item{bins}{Integer. Number of bins to use for the x-axis histogram (default is 50).}

\item{n_fill_bins}{Integer. Number of bins to use for binning the fill variable (must be odd; default is 9). Bins are centered at 0 and symmetric. The outermost bins are labeled with \code{<=} and \code{>=}.}
}
\value{
A \code{ggplot2} object showing a histogram of \code{x_var}, with bars stacked and colored by binned values of \code{fill_var}. Faceting is applied if specified.
}
\description{
Visualizes the distribution of a variable (typically p-values) using a stacked histogram.
Bars are colored based on binned values of a second variable (e.g., a test statistic), centered around zero.
Out-of-range values are grouped into outermost bins labeled with `<=` and `>=`.
The plot can be optionally faceted by a categorical column.
}
\examples{
# Basic histogram
plot_pvalue_distribution(data = agg_perm, x_var = "p_value", fill_var = "T_obs")

# Faceted by cluster
plot_pvalue_distribution(
  data = agg_perm,
  x_var = "p_value",
  fill_var = "T_obs",
  facet_col = "cluster"
)

}
