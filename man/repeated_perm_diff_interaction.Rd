% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/repeated_perm_diff_interaction.R
\name{repeated_perm_diff_interaction}
\alias{repeated_perm_diff_interaction}
\title{Repeated Permutation Interaction Test on Stratified Subsets}
\usage{
repeated_perm_diff_interaction(
  X,
  Y,
  MX,
  MY,
  stratify_cols,
  g_col,
  a_col,
  features = NULL,
  n_iter = 50,
  B = 100,
  seed = 42
)
}
\arguments{
\item{X}{Expression matrix (samples Ã— genes) for the overrepresented ancestry.}

\item{Y}{Expression matrix for the underrepresented ancestry.}

\item{MX}{Metadata for X.}

\item{MY}{Metadata for Y.}

\item{stratify_cols}{Character vector of metadata column names to stratify by.}

\item{g_col}{Name of the grouping variable (e.g., "condition").}

\item{a_col}{Name of the ancestry variable.}

\item{features}{Optional vector of feature names to include (default: all).}

\item{n_iter}{Number of stratified subsample iterations.}

\item{B}{Number of permutations in each `perm_interaction()` call.}

\item{seed}{Base random seed for reproducibility.}
}
\value{
A list with:
\describe{
  \item{aggregated}{Data frame with per-feature summary across iterations.}
  \item{all_iterations}{Combined data frame of all summary_stats results.}
  \item{metadata}{Info about run parameters.}
}
}
\description{
Performs multiple stratified subsamples of the overrepresented group,
runs `perm_interaction()` on each, and aggregates the results.
}
