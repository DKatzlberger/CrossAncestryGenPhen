% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perm_diff_interaction.R
\name{perm_diff_interaction}
\alias{perm_diff_interaction}
\title{Permutation-Based Interaction Test (Adaptive or Fixed)}
\usage{
perm_diff_interaction(
  X,
  Y,
  MX,
  MY,
  g_col,
  a_col,
  B = NULL,
  seed = NULL,
  min_iter = 500,
  max_iter = 50000,
  tol = 0.001,
  batch_size = 100,
  check_convergence = TRUE
)
}
\arguments{
\item{X}{A numeric matrix of expression values for ancestry A.
Rows = samples, columns = genes.}

\item{Y}{A numeric matrix of expression values for ancestry B.
Rows = samples, columns = genes.}

\item{MX}{A data.frame of metadata for X. Must include group and ancestry info.}

\item{MY}{A data.frame of metadata for Y. Must include group and ancestry info.}

\item{g_col}{Name of the column in metadata indicating the condition/group.}

\item{a_col}{Name of the column in metadata indicating ancestry.}

\item{B}{Integer. Number of permutations (set to \code{NULL} to enable adaptive mode).}

\item{seed}{Optional random seed for reproducibility.}

\item{min_iter}{Minimum number of permutations to run before checking convergence (adaptive mode).}

\item{max_iter}{Maximum number of permutations allowed (adaptive mode).}

\item{tol}{Tolerance threshold for convergence of empirical p-values (adaptive mode).}

\item{batch_size}{Number of permutations to add per iteration when checking convergence.}

\item{check_convergence}{Logical. Whether to check convergence in fixed-\code{B} mode.}
}
\value{
A list with the following elements:
}
\description{
Performs a permutation test for interaction between conditions across ancestries.
Supports both a fixed number of permutations (\code{B}) and an adaptive mode
(\code{B = NULL}), where permutations are run until empirical p-values converge.
}
\details{
The input expression matrices must have \strong{samples as rows} and \strong{genes as columns}.
Meta-data must contain consistent group and ancestry annotations for each sample.
}
