% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_4group_expression.R
\name{sim_4group_expression}
\alias{sim_4group_expression}
\title{Simulate RNA-seq Expression Data for Four Groups (Two Ancestries Ã— Two Conditions)}
\usage{
sim_4group_expression(
  estimates_X = NULL,
  estimates_Y = NULL,
  ancestry_X,
  ancestry_Y,
  n_samples_X,
  n_samples_Y,
  n_degs_X,
  n_degs_Y,
  log2FC_X,
  log2FC_Y,
  mean_method = c("mle", "map", "libnorm_mle", "libnorm_map"),
  disp_method = c("mle", "map"),
  seed = NULL
)
}
\arguments{
\item{estimates_X}{Optional list of parameter estimates from \code{\link{estimate_params}}
for ancestry X. If \code{NULL}, parameters are estimated from \code{X}.}

\item{estimates_Y}{Optional list of parameter estimates from \code{\link{estimate_params}}
for ancestry Y. If \code{NULL}, parameters are estimated from \code{Y}.}

\item{ancestry_X}{Character scalar giving the ancestry label for \code{X}.}

\item{ancestry_Y}{Character scalar giving the ancestry label for \code{Y}.}

\item{n_samples_X}{Integer, number of samples to simulate per condition for ancestry X.}

\item{n_samples_Y}{Integer, number of samples to simulate per condition for ancestry Y.}

\item{n_degs_X}{Integer, number of differentially expressed genes to simulate in ancestry X.}

\item{n_degs_Y}{Integer, number of differentially expressed genes to simulate in ancestry Y.}

\item{log2FC_X}{Numeric, log2 fold-change magnitude for DEGs in ancestry X.}

\item{log2FC_Y}{Numeric, log2 fold-change magnitude for DEGs in ancestry Y.}

\item{mean_method}{Character string, method to use for mean estimates in both ancestries.
One of \code{"mle"}, \code{"map"}, \code{"libnorm_mle"}, \code{"libnorm_map"}.}

\item{disp_method}{Character string, method to use for dispersion estimates in both ancestries.
One of \code{"mle"}, \code{"map"}.}

\item{seed}{Optional integer random seed for reproducibility. The simulation
for ancestry Y will use \code{seed + 1000} to ensure different DE gene sets.}

\item{X}{Numeric matrix or data frame of counts for the first ancestry
(samples in rows, genes in columns).}

\item{Y}{Numeric matrix or data frame of counts for the second ancestry
(samples in rows, genes in columns).}
}
\value{
A list with the following elements:
\describe{
  \item{\code{X}}{Simulated count matrix (samples x genes) for ancestry X.}
  \item{\code{Y}}{Simulated count matrix (samples x genes) for ancestry Y.}
  \item{\code{MX}}{Sample metadata for ancestry X.}
  \item{\code{MY}}{Sample metadata for ancestry Y.}
  \item{\code{fX}}{Gene-level features (DE status, true log2FC) for ancestry X.}
  \item{\code{fY}}{Gene-level features (DE status, true log2FC) for ancestry Y.}
  \item{\code{pX}}{List of ggplot objects comparing means and dispersions for ancestry X.}
  \item{\code{pY}}{List of ggplot objects comparing means and dispersions for ancestry Y.}
  \item{\code{fI}}{Data frame of interaction effects, with DE status and true interaction log2FC.}
}
}
\description{
Generate simulated RNA-seq count matrices for two ancestries, each with two
conditions, based on parameters estimated from real data. This function calls
\code{\link{sim_2group_expression}} twice (once per ancestry) and then calculates
the true interaction effects between ancestries for each gene.
}
\details{
The interaction effect for each gene is defined as:
\deqn{\mathrm{Interaction\ log2FC} = \mathrm{log2FC}_Y - \mathrm{log2FC}_X}
where \eqn{\mathrm{log2FC}_X} and \eqn{\mathrm{log2FC}_Y} are the true log2
fold-changes from the simulated data for ancestry X and Y respectively.
}
\seealso{
\code{\link{sim_2group_expression}}
}
