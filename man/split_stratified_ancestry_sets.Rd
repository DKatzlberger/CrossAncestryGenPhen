% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/split_stratified_ancestry_sets.R
\name{split_stratified_ancestry_sets}
\alias{split_stratified_ancestry_sets}
\title{Split Expression and Metadata into Train, Test, and Inference Sets}
\usage{
split_stratified_ancestry_sets(X, Y, MX, MY, stratify_cols = NULL, seed = NULL)
}
\arguments{
\item{X}{A numeric matrix (samples x genes) for the overrepresented ancestry group.}

\item{Y}{A numeric matrix for the underrepresented ancestry group.}

\item{MX}{A data.frame of metadata corresponding to X (same number of rows).}

\item{MY}{A data.frame of metadata corresponding to Y (same number of rows).}

\item{stratify_cols}{A character vector of column names in metadata to stratify by.}

\item{seed}{An optional integer used to set the random seed.}
}
\value{
A list with three named elements:
\describe{
  \item{train}{List with `expr` and `meta` for subsampled overrepresented group.}
  \item{test}{List with `expr` and `meta` for the remaining overrepresented samples.}
  \item{inference}{List with `expr` and `meta` for the underrepresented ancestry.}
}
}
\description{
Subsamples the overrepresented ancestry to match the underrepresented ancestry,
stratifying by metadata columns. Returns train, test, and inference sets.
Issues a warning when any strata from the underrepresented group
cannot be matched due to missing or insufficient samples in the overrepresented group.
}
