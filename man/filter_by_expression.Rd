% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_by_expression.R
\name{filter_by_expression}
\alias{filter_by_expression}
\title{Filter expression data by ancestry and phenotype}
\usage{
filter_by_expression(X, Y, MX, MY, g_col, a_col, verbose = TRUE, plot = TRUE)
}
\arguments{
\item{X}{Matrix of counts (rows = samples, cols = features) for ancestry X.}

\item{Y}{Matrix of counts for ancestry Y.}

\item{MX}{Metadata for X (data.frame, rownames = sample IDs).}

\item{MY}{Metadata for Y (data.frame, rownames = sample IDs).}

\item{g_col}{Name of phenotype column in metadata (factor with 2 levels).}

\item{a_col}{Name of ancestry column in metadata (1 level per block).}

\item{verbose}{Print summary (default TRUE).}

\item{plot}{Return mean–variance trend plot if available (default TRUE).}
}
\value{
A list with:
\itemize{
  \item `X`, `Y`: lists with `counts`, `meta`, and `ancestry`
  \item `mrna`, `meta`: combined filtered data
  \item `keep`: logical vector of kept genes
  \item `n_features`: number of retained genes
  \item `dge`: filtered `edgeR::DGEList`
  \item `g_levels`, `a_levels`: factor levels used
  \item `plot`: MV-trend plot (or `NULL`)
}
}
\description{
Combines two ancestry-specific matrices (`X`, `Y`) with their metadata (`MX`, `MY`),
filters genes using `edgeR::filterByExpr` with groups defined by
`interaction(meta[[a_col]], meta[[g_col]])`, and re-splits the filtered data
using `subset_phenotype_ancestry()`. Supports only 2×2 designs
(two ancestry levels × two phenotype levels).
}
