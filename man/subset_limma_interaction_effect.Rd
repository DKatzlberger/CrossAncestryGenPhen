% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subset_limma_interaction_effect.R
\name{subset_limma_interaction_effect}
\alias{subset_limma_interaction_effect}
\title{Subset Limma Interaction Effect with Stratified Cross-Validation}
\usage{
subset_limma_interaction_effect(
  X,
  Y,
  MX,
  MY,
  g_col,
  a_col,
  covariates = NULL,
  use_voom = TRUE,
  n_iter = 1000,
  agg_method = c("mean", "cct", "fisher", "bonferroni", "all"),
  seed = NULL,
  verbose = TRUE,
  workers = future::availableCores() - 1
)
}
\arguments{
\item{X}{A data frame or matrix of features (genotypes or other predictors).}

\item{Y}{A response vector or matrix.}

\item{MX}{Additional metadata or covariates for `X`.}

\item{MY}{Additional metadata or covariates for `Y`.}

\item{g_col}{Name of the genotype column in `X` used for interaction.}

\item{a_col}{Name of the ancestry column used for stratified splitting.}

\item{covariates}{Optional vector of covariate column names to adjust for.}

\item{use_voom}{Logical; whether to use limma-voom (default: TRUE).}

\item{n_iter}{Integer. Number of iterations to run. Default is 1000.}

\item{agg_method}{Method for aggregating p-values across iterations. Options: "mean", "cct", "fisher", "bonferroni", "all".}

\item{seed}{Optional integer for random seed to ensure reproducibility.}

\item{verbose}{Logical; whether to print progress messages.}

\item{workers}{Number of parallel workers to use. Defaults to `future::availableCores() - 1` (reserving one core).}
}
\value{
A list with the following elements:
\describe{
  \item{summary_stats}{Data frame with aggregated summary statistics across iterations.}
  \item{subsets_stats}{Data frame with iteration-level statistics.}
  \item{samples_stats}{Data frame logging sample IDs used in each split.}
}
}
\description{
Runs stratified train/test splits with ancestry sets and estimates 
interaction effects using limma in parallel across multiple iterations.
Returns aggregated statistics, iteration-level stats, and sample logs.
}
