% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_by_methylation.R
\name{filter_by_methylation}
\alias{filter_by_methylation}
\title{Filter methylation data by ancestry and phenotype}
\usage{
filter_by_methylation(
  X,
  Y,
  MX,
  MY,
  g_col,
  a_col,
  mean_q = c(0.2, 0.9),
  var_q = 0.2,
  verbose = TRUE,
  plot = TRUE
)
}
\arguments{
\item{X}{Matrix of beta-values (rows = samples, cols = features) for ancestry X.}

\item{Y}{Matrix of beta-values for ancestry Y.}

\item{MX}{Metadata for X (data.frame, rownames = sample IDs).}

\item{MY}{Metadata for Y (data.frame, rownames = sample IDs).}

\item{g_col}{Name of phenotype column in metadata (factor with 2 levels).}

\item{a_col}{Name of ancestry column in metadata (1 level per block).}

\item{mean_q}{Quantile cutoffs for mean beta-values (default = c(0.2, 0.9)).}

\item{var_q}{Lower quantile cutoff for variance (default = 0.2).}

\item{verbose}{Print summary (default TRUE).}

\item{plot}{Return mean–variance scatter plot (default TRUE).}
}
\description{
Combines two ancestry-specific matrices (`X`, `Y`) with their metadata (`MX`, `MY`),
filters genes/probes by mean beta-value and variance across samples,
and re-splits the filtered data using `subset_phenotype_ancestry()`.
Supports only 2×2 designs (two ancestry levels × two phenotype levels).
}
