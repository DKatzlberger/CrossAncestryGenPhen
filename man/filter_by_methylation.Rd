% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_by_methylation.R
\name{filter_by_methylation}
\alias{filter_by_methylation}
\title{Filter methylation data by ancestry and phenotype}
\usage{
filter_by_methylation(
  X,
  Y,
  MX,
  MY,
  g_col,
  a_col,
  any_group = TRUE,
  var_q = 0.2,
  verbose = TRUE,
  plot = TRUE
)
}
\arguments{
\item{X}{Matrix of beta-values (rows = samples, cols = CpGs) for ancestry X.}

\item{Y}{Matrix of beta-values for ancestry Y.}

\item{MX}{Metadata for X (data.frame; rownames must match rownames of X).}

\item{MY}{Metadata for Y (data.frame; rownames must match rownames of Y).}

\item{g_col}{Name of phenotype column in metadata (factor with 2 levels).}

\item{a_col}{Name of ancestry column in metadata (factor/character, 1 level per block).}

\item{any_group}{Logical; if TRUE, filter variance within ancestry×phenotype groups.
If FALSE, treat all samples as one population (global variance filter).}

\item{var_q}{Lower quantile cutoff for variance (default = 0.20).}

\item{verbose}{Print summary (default TRUE).}

\item{plot}{Print variance plot (default TRUE).}
}
\description{
Combines two ancestry-specific matrices (`X`, `Y`) with their metadata (`MX`, `MY`),
filters CpGs **only by variance** across samples, optionally within
ancestry × phenotype groups. Never uses mean beta-values for filtering.
}
\details{
Supports only 2×2 designs (two levels in `g_col` × two levels in `a_col`).
}
