% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_phenotype_ancestry.R
\name{filter_phenotype_ancestry}
\alias{filter_phenotype_ancestry}
\title{Subset metadata and expression by ancestry and phenotype}
\usage{
filter_phenotype_ancestry(
  X,
  M,
  g_col,
  a_col,
  g_levels,
  a_levels,
  covariates = NULL,
  omit_na = FALSE,
  auto_cast = FALSE,
  plot = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{X}{A numeric matrix of features (rows = samples, columns = features).}

\item{M}{A data frame containing sample metadata (must have rownames matching `rownames(X)`).}

\item{g_col}{A character string specifying the metadata column containing phenotype labels.}

\item{a_col}{A character string specifying the metadata column containing ancestry labels.}

\item{g_levels}{A character vector of length 2 giving the phenotype levels to retain (order determines reference vs. comparison).}

\item{a_levels}{A character vector of length 2 giving the ancestry levels to retain (first becomes group X, second group Y).}

\item{covariates}{Optional character vector of additional metadata columns to include during NA checking (e.g., age).}

\item{omit_na}{Logical; if `TRUE`, missing values in any of the required metadata columns (`g_col`, `a_col`, `covariates`) are removed.}

\item{auto_cast}{Logical; if `TRUE`, covariates are automatically cast into classes.}

\item{plot}{Logical; if `TRUE` (default), prints the imbalance plot showing phenotype frequencies across ancestry groups.}

\item{verbose}{Logical; if `TRUE` (default), prints detailed progress and summary information.}
}
\description{
Filters metadata (`M`) and a matching feature matrix (`X`) to two selected
ancestry levels and two phenotype levels, then splits the data into two
groups (X/Y) based on ancestry. Optionally removes samples with missing
values in required metadata columns.
}
