% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RP_aggregation.R
\name{RP_aggregation}
\alias{RP_aggregation}
\title{Aggregate gene statistics using Rank Product}
\usage{
RP_aggregation(
  x,
  fdr_threshold = 0.05,
  jitter_p = FALSE,
  jitter_amount = 1e-06
)
}
\arguments{
\item{x}{A data.frame with at least the following columns:
\itemize{
  \item \code{feature}: Gene or feature identifier.
  \item \code{T_obs}: Observed test statistic per iteration.
  \item \code{p_value}: Raw p-value.
  \item \code{p_adj}: FDR-adjusted p-value.
  \item \code{iteration}: Replicate or study identifier.
}}

\item{fdr_threshold}{Numeric. FDR-adjusted p-value threshold used
to determine significance (default is 0.05).}

\item{jitter_p}{Logical. Whether to apply small uniform random jitter to p-values
to break ties and improve rank resolution (default is FALSE).}

\item{jitter_amount}{Numeric. Maximum amount of uniform noise to add to
p-values during jittering (default is 1e-6).}
}
\value{
A data.frame with the following columns:
  \itemize{
    \item \code{feature}: Gene or feature identifier.
    \item \code{mean_T_obs}: Mean of observed test statistics across iterations.
    \item \code{RP}: Rank Product score (lower = stronger consistent signal).
    \item \code{prop_sig}: Proportion of iterations with FDR-adjusted p < \code{fdr_threshold}.
  }
}
\description{
This function aggregates results from multiple iterations or studies
by calculating the Rank Product (RP) of raw p-values, the mean of
test statistics (`T_obs`), and the proportion of significance based
on FDR-adjusted p-values. Optionally applies jitter to p-values to
break ties in low-resolution data. If jitter is not applied, the
function reports the fraction of tied p-values in each iteration
and the mean fraction across iterations to help users assess whether
jittering might be appropriate.
}
\examples{
\dontrun{
result <- RP_aggregation(
  combined_results,
  jitter_p = TRUE,
  jitter_amount = 1e-6
)
head(result)
}
}
