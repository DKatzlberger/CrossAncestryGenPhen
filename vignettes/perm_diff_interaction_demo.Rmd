---
title: "Example on how to use perm_diff_interaction()"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Example on how to use perm_diff_interaction()}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r example}
library(CrossAncestryGenPhen)

set.seed(1)

n_per_group <- 10
p <- 500

X <- matrix(rnorm(n_per_group * 2 * p), nrow = n_per_group * 2, ncol = p)
Y <- matrix(rnorm(n_per_group * 2 * p), nrow = n_per_group * 2, ncol = p)
colnames(X) <- colnames(Y) <- paste0("Gene_", seq_len(p))

MX <- data.frame(
  condition = factor(rep(c("A", "B"), each = n_per_group)),
  ancestry = "EUR"
)

MY <- data.frame(
  condition = factor(rep(c("A", "B"), each = n_per_group)),
  ancestry = "AFR"
)

result <- perm_diff_interaction(
  X = X, 
  Y = Y,
  MX = MX, 
  MY = MY,
  g_col = "condition",
  a_col = "ancestry",
  B = 50,
  seed = 42
)

head(result$summary_stats)
```